<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Global University Finder</title>
    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    <div class="container">
      <nav class="navBar" aria-label="Primary">
        <div class="logo">
          <a href="#">
            <img
              src="/icons/university-icon.png"
              alt="Global University Finder logo"
            />
            <span>Global<span style="color: var(--brand)">U</span> Finder</span>
          </a>
        </div>
        <ul>
          <li>Home</li>
          <li>About Us</li>
          <li>Contact</li>
        </ul>
      </nav>

      <section class="hero-card">
        <div class="head">
          <h1>Global University Finder</h1>
          <p>Find your dream university with a clean, fast search.</p>

          <div class="search-wrap">
            <form
              class="search"
              role="search"
              aria-label="Search universities"
              onsubmit="return false;"
            >
              <div class="icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                  <circle
                    cx="11"
                    cy="11"
                    r="7"
                    stroke="currentColor"
                    stroke-width="2"
                  />
                  <line
                    x1="16.65"
                    y1="16.65"
                    x2="21"
                    y2="21"
                    stroke="currentColor"
                    stroke-width="2"
                  />
                </svg>
              </div>

              <input
                id="userInput"
                type="text"
                placeholder="Search universities by name"
                autocomplete="off"
                aria-label="Search by university name"
              />

              <label class="select" for="dropDown" aria-label="Select country">
                <select name="country" id="dropDown" aria-label="Country">
                  <option value="">All countries</option>
                </select>
              </label>
            </form>
          </div>
        </div>
      </section>

      <section class="results-section" aria-live="polite">
        <div class="results-meta">
          <span id="result-count">Showing 0 results</span>
        </div>

        <div
          id="results"
          class="results-grid"
          aria-label="Search results"
        ></div>

        <div id="empty" class="empty">
          Start typing to search, or choose a country to explore universities.
        </div>
      </section>
    </div>

    <script>
      (function () {
        const refs = {
          grid: document.getElementById("results"),
          empty: document.getElementById("empty"),
          count: document.getElementById("result-count"),
        };

        function setResultCount(n) {
          if (!refs.count) return;
          refs.count.textContent = `Showing ${n} result${n === 1 ? "" : "s"}`;
        }

        function toggleEmpty(show) {
          if (!refs.empty) return;
          refs.empty.classList.toggle("is-hidden", !show);
          refs.empty.hidden = !show; // double insurance
        }

        function clearResults() {
          if (refs.grid) refs.grid.innerHTML = "";
        }

        function makeLink(url) {
          const a = document.createElement("a");
          a.href = url;
          a.target = "_blank";
          a.rel = "noopener noreferrer";
          a.textContent = url.replace(/^https?:\/\//, "");
          return a;
        }

        function renderUniversities(list = []) {
          if (!refs.grid) return;

          clearResults();

          if (!Array.isArray(list) || list.length === 0) {
            toggleEmpty(true);
            setResultCount(0);
            return;
          }

          toggleEmpty(false);
          setResultCount(list.length);

          list.forEach((u) => {
            const name = u.name || "Unnamed University";
            const country = u.country || "";
            const code = (u.alpha_two_code || "").toString().toUpperCase();
            const pages = Array.isArray(u.web_pages)
              ? u.web_pages
              : u.website
              ? [u.website]
              : [];
            const primary = pages[0];

            const card = document.createElement("article");
            card.className = "uni-card";

            const title = document.createElement("h3");
            title.className = "uni-name";
            title.textContent = name;

            const metaRow = document.createElement("div");
            metaRow.className = "meta-row";

            const badge = document.createElement("span");
            badge.className = "badge";
            badge.textContent = country
              ? code
                ? `${country} · ${code}`
                : country
              : "—";

            const links = document.createElement("div");
            links.className = "links";
            if (primary) {
              links.appendChild(makeLink(primary));
            }

            metaRow.appendChild(badge);
            card.appendChild(title);
            card.appendChild(metaRow);
            card.appendChild(links);
            refs.grid.appendChild(card);
          });
        }

        // Demo render so you can see boxes immediately
        document.addEventListener("DOMContentLoaded", () => {
          const demo = [
            {
              name: "University of Karachi",
              country: "Pakistan",
              alpha_two_code: "PK",
              web_pages: ["https://uok.edu.pk"],
            },
            {
              name: "MIT",
              country: "United States",
              alpha_two_code: "US",
              web_pages: ["http://web.mit.edu"],
            },
            {
              name: "University of Tokyo",
              country: "Japan",
              alpha_two_code: "JP",
              web_pages: ["https://www.u-tokyo.ac.jp"],
            },
          ];
          renderUniversities(demo);
        });

        // Expose safe globals for your app.js
        window.renderUniversities = renderUniversities;
        window.setResultCount = setResultCount;
        window.clearResults = clearResults;
      })();
    </script>

    <script src="app.js"></script>
  </body>
</html>
